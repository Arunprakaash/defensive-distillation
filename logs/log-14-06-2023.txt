~/defensive-distillation# python main.py 
2023-06-14 15:20:58.547945: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-06-14 15:20:59.484734: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz
11490434/11490434 [==============================] - 1s 0us/step
2023-06-14 15:21:02.742224: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:03.282949: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:03.283321: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:03.284463: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:03.284747: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:03.285018: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:05.957059: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:05.958489: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:05.959564: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:996] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero. See more at https://github.com/torvalds/linux/blob/v6.0/Documentation/ABI/testing/sysfs-bus-pci#L344-L355
2023-06-14 15:21:05.960350: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:47] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
2023-06-14 15:21:05.960931: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1635] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 13664 MB memory:  -> device: 0, name: Tesla T4, pci bus id: 0000:00:04.0, compute capability: 7.5
Epoch 1/25
2023-06-14 15:21:11.472278: I tensorflow/compiler/xla/stream_executor/cuda/cuda_dnn.cc:424] Loaded cuDNN version 8700
2023-06-14 15:21:15.547576: I tensorflow/compiler/xla/service/service.cc:169] XLA service 0x25382f60 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2023-06-14 15:21:15.547628: I tensorflow/compiler/xla/service/service.cc:177]   StreamExecutor device (0): Tesla T4, Compute Capability 7.5
2023-06-14 15:21:15.689051: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:269] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2023-06-14 15:21:16.210966: I ./tensorflow/compiler/jit/device_compiler.h:180] Compiled cluster using XLA!  This line is logged at most once for the lifetime of the process.
938/938 [==============================] - 17s 6ms/step - loss: 0.1660 - accuracy: 0.9505 - val_loss: 0.0482 - val_accuracy: 0.9841
Epoch 2/25
938/938 [==============================] - 6s 6ms/step - loss: 0.0479 - accuracy: 0.9858 - val_loss: 0.0356 - val_accuracy: 0.9888
Epoch 3/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0342 - accuracy: 0.9894 - val_loss: 0.0311 - val_accuracy: 0.9896
Epoch 4/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0248 - accuracy: 0.9922 - val_loss: 0.0250 - val_accuracy: 0.9916
Epoch 5/25
938/938 [==============================] - 5s 6ms/step - loss: 0.0187 - accuracy: 0.9940 - val_loss: 0.0285 - val_accuracy: 0.9910
Epoch 6/25
938/938 [==============================] - 5s 5ms/step - loss: 0.0154 - accuracy: 0.9949 - val_loss: 0.0308 - val_accuracy: 0.9893
Epoch 7/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0107 - accuracy: 0.9964 - val_loss: 0.0452 - val_accuracy: 0.9862
Epoch 8/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0096 - accuracy: 0.9970 - val_loss: 0.0276 - val_accuracy: 0.9916
Epoch 9/25
938/938 [==============================] - 5s 6ms/step - loss: 0.0084 - accuracy: 0.9973 - val_loss: 0.0293 - val_accuracy: 0.9917
Epoch 10/25
938/938 [==============================] - 5s 5ms/step - loss: 0.0051 - accuracy: 0.9984 - val_loss: 0.0371 - val_accuracy: 0.9883
Epoch 11/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0067 - accuracy: 0.9977 - val_loss: 0.0275 - val_accuracy: 0.9921
Epoch 12/25
938/938 [==============================] - 4s 5ms/step - loss: 0.0041 - accuracy: 0.9986 - val_loss: 0.0390 - val_accuracy: 0.9908
Epoch 13/25
938/938 [==============================] - 6s 6ms/step - loss: 0.0053 - accuracy: 0.9980 - val_loss: 0.0372 - val_accuracy: 0.9899
Epoch 14/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0037 - accuracy: 0.9989 - val_loss: 0.0448 - val_accuracy: 0.9909
Epoch 15/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0046 - accuracy: 0.9984 - val_loss: 0.0402 - val_accuracy: 0.9907
Epoch 16/25
938/938 [==============================] - 5s 5ms/step - loss: 0.0046 - accuracy: 0.9983 - val_loss: 0.0338 - val_accuracy: 0.9918
Epoch 17/25
938/938 [==============================] - 6s 6ms/step - loss: 0.0020 - accuracy: 0.9994 - val_loss: 0.0315 - val_accuracy: 0.9931
Epoch 18/25
938/938 [==============================] - 4s 5ms/step - loss: 0.0030 - accuracy: 0.9990 - val_loss: 0.0439 - val_accuracy: 0.9904
Epoch 19/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0042 - accuracy: 0.9988 - val_loss: 0.0378 - val_accuracy: 0.9923
Epoch 20/25
938/938 [==============================] - 5s 5ms/step - loss: 0.0037 - accuracy: 0.9989 - val_loss: 0.0423 - val_accuracy: 0.9918
Epoch 21/25
938/938 [==============================] - 5s 5ms/step - loss: 0.0013 - accuracy: 0.9997 - val_loss: 0.0367 - val_accuracy: 0.9919
Epoch 22/25
938/938 [==============================] - 4s 5ms/step - loss: 0.0038 - accuracy: 0.9987 - val_loss: 0.0440 - val_accuracy: 0.9911
Epoch 23/25
938/938 [==============================] - 4s 4ms/step - loss: 0.0016 - accuracy: 0.9994 - val_loss: 0.0483 - val_accuracy: 0.9911
Epoch 24/25
938/938 [==============================] - 6s 6ms/step - loss: 0.0027 - accuracy: 0.9993 - val_loss: 0.0545 - val_accuracy: 0.9899
Epoch 25/25
938/938 [==============================] - 5s 5ms/step - loss: 0.0034 - accuracy: 0.9991 - val_loss: 0.0326 - val_accuracy: 0.9930
1875/1875 [==============================] - 3s 2ms/step
Epoch 1/25
938/938 [==============================] - 8s 6ms/step - loss: 2.3026 - accuracy: 0.8073 - val_loss: 2.2838 - val_accuracy: 0.9683
Epoch 2/25
938/938 [==============================] - 4s 5ms/step - loss: 2.3026 - accuracy: 0.9718 - val_loss: 2.2821 - val_accuracy: 0.9812
Epoch 3/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9816 - val_loss: 2.2822 - val_accuracy: 0.9853
Epoch 4/25
938/938 [==============================] - 5s 5ms/step - loss: 2.3026 - accuracy: 0.9862 - val_loss: 2.2809 - val_accuracy: 0.9871
Epoch 5/25
938/938 [==============================] - 5s 6ms/step - loss: 2.3026 - accuracy: 0.9888 - val_loss: 2.2812 - val_accuracy: 0.9879
Epoch 6/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9900 - val_loss: 2.2814 - val_accuracy: 0.9879
Epoch 7/25
938/938 [==============================] - 4s 5ms/step - loss: 2.3026 - accuracy: 0.9917 - val_loss: 2.2812 - val_accuracy: 0.9890
Epoch 8/25
938/938 [==============================] - 5s 6ms/step - loss: 2.3026 - accuracy: 0.9928 - val_loss: 2.2811 - val_accuracy: 0.9886
Epoch 9/25
938/938 [==============================] - 5s 5ms/step - loss: 2.3026 - accuracy: 0.9934 - val_loss: 2.2805 - val_accuracy: 0.9903
Epoch 10/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9940 - val_loss: 2.2813 - val_accuracy: 0.9912
Epoch 11/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9947 - val_loss: 2.2811 - val_accuracy: 0.9913
Epoch 12/25
938/938 [==============================] - 6s 6ms/step - loss: 2.3026 - accuracy: 0.9948 - val_loss: 2.2807 - val_accuracy: 0.9915
Epoch 13/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9954 - val_loss: 2.2809 - val_accuracy: 0.9906
Epoch 14/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9957 - val_loss: 2.2812 - val_accuracy: 0.9916
Epoch 15/25
938/938 [==============================] - 5s 5ms/step - loss: 2.3026 - accuracy: 0.9959 - val_loss: 2.2808 - val_accuracy: 0.9918
Epoch 16/25
938/938 [==============================] - 5s 6ms/step - loss: 2.3026 - accuracy: 0.9963 - val_loss: 2.2807 - val_accuracy: 0.9921
Epoch 17/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9964 - val_loss: 2.2809 - val_accuracy: 0.9909
Epoch 18/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9967 - val_loss: 2.2810 - val_accuracy: 0.9916
Epoch 19/25
938/938 [==============================] - 5s 5ms/step - loss: 2.3026 - accuracy: 0.9969 - val_loss: 2.2809 - val_accuracy: 0.9925
Epoch 20/25
938/938 [==============================] - 5s 6ms/step - loss: 2.3026 - accuracy: 0.9972 - val_loss: 2.2811 - val_accuracy: 0.9913
Epoch 21/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9973 - val_loss: 2.2811 - val_accuracy: 0.9918
Epoch 22/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9975 - val_loss: 2.2807 - val_accuracy: 0.9922
Epoch 23/25
938/938 [==============================] - 5s 5ms/step - loss: 2.3026 - accuracy: 0.9976 - val_loss: 2.2807 - val_accuracy: 0.9915
Epoch 24/25
938/938 [==============================] - 5s 5ms/step - loss: 2.3026 - accuracy: 0.9977 - val_loss: 2.2812 - val_accuracy: 0.9915
Epoch 25/25
938/938 [==============================] - 4s 4ms/step - loss: 2.3026 - accuracy: 0.9978 - val_loss: 2.2806 - val_accuracy: 0.9913